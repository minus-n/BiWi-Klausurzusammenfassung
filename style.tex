% This file contains definitions related to the style of the questions



% ========================================
% Primary definitions (not intended for direct use)
% ========================================

\usepackage{xfp}

%% thank you, internet
\usepackage{enumitem}
\usepackage{amssymb}
\usepackage{pifont}
\usepackage{wasysym}
\usepackage{graphicx}
\usepackage{tcolorbox}

% helpers for multiple choice questions
\newcommand{\ACorrectAnswer}{\rlap{$\square$}{\raisebox{2pt}{\large\hspace{1pt}\ding{51}}}\hspace{-2.5pt}}
\newcommand{\AWrongAnswer}{\rlap{$\square$}{\large\hspace{1pt}\ding{55}}}
\newcommand{\AnUnsureAnswer}{\rlap{$\square$}{\large\hspace{1pt}\textbf?}}
\newlist{multiple-choice-list}{itemize}{2}
\setlist[multiple-choice-list]{label=$\square$}

% helpers for single-choice questions
\newlist{single-choice-list}{itemize}{2}
\setlist[single-choice-list]{label=$\ocircle$}
\newcommand{\TheCorrectAnswer}{\rlap{\hspace{1.4pt}$\bullet$}{$\ocircle$}}
\newcommand{\TheWrongAnswer}{$\ocircle$}
\newcommand{\TheUnsureAnswer}{\rlap{\hspace{1.4pt}\textbf?}{$\ocircle$}}
% thank you, internet

% helpers for mapping questions
\newtcolorbox{mapping-box}{colback=black!5,colframe=black!75,sidebyside}

\newcommand{\defaultCorrect}{\ding{51}}
\newcommand{\defaultWrong}{\ding{55}}
\newcommand{\defaultUnsure}{\textbf{?}}


% ========================================
% Secondary definition (intended for use in the document)
% ========================================


% those definitions will change
\newenvironment{answers}{\begin{itemize}}{\end{itemize}}

\newcommand{\correct}{\defaultCorrect}
\newcommand{\wrong}{\defaultWrong}
\newcommand{\unsure}{\defaultUnsure}

\usepackage{environ}
\makeatletter
\environbodyname\BODY@question

\setcounter{secnumdepth}{0}
\NewEnviron{question}[2]{%
    \begin{SortThisQuestion}{#1 (#2)}%
    \section[#1 \normalfont(#2)]{#1\\\small\normalfont\hyperlink{tableofcontents}{zur√ºck zum Inhaltsverzeichnis}}%
    \expandafter{\BODY@question}
    \newpage%
    \end{SortThisQuestion}%
}

\newcommand{\questiontext}[1]{\textbf{#1}}
\newcommand{\assignment}[1]{\textbf{\textit{#1}}\newline}

\environbodyname\BODY@MultipleChoice
\NewEnviron{multiple-choice}[1]{%
    \begin{question}{#1}{Multiple Choice}%
    \renewenvironment{answers}{%
        \begin{multiple-choice-list}}{\end{multiple-choice-list}%
    }%
    \renewcommand{\correct}{\ACorrectAnswer}%
    \renewcommand{\wrong}{\AWrongAnswer}%
    \renewcommand{\unsure}{\AnUnsureAnswer}%
\BODY@MultipleChoice
    \renewcommand{\correct}{\defaultCorrect}%
    \renewcommand{\wrong}{\defaultWrong}%
    \renewcommand{\unsure}{\defaultUnsure}%
    \end{question}%
}

\environbodyname\BODY@SingleChoice
\NewEnviron{single-choice}[1]{%
    \begin{question}{#1}{Single Choice}%
    \renewenvironment{answers}{%
        \begin{single-choice-list}}{\end{single-choice-list}%
    }%
    \renewcommand{\correct}{\TheCorrectAnswer}%
    \renewcommand{\wrong}{\TheWrongAnswer}%
    \renewcommand{\unsure}{TheUnsureAnswer}%
    \BODY@SingleChoice
    \renewcommand{\correct}{\defaultCorrect}%
    \renewcommand{\wrong}{\defaultWrong}%
    \renewcommand{\unsure}{\defaultUnsure}%
    \end{question}%
}

\newcommand{\ismappedto}{\tcblower}
\newenvironment{answer}{\begin{mapping-box}}{\end{mapping-box}}%
\environbodyname\BODY@Mapping
\NewEnviron{mapping}[1]{%
    \begin{question}{#1}{Zuordnungsaufgabe}%
    \BODY@Mapping
    \end{question}%
}

\environbodyname\BODY
\makeatother